<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>For My Love ❤️ — Advanced</title>
  <meta name="description" content="A more advanced interactive love page with animations, gallery, music, confetti and accessibility." />

  <style>
    :root{
      --bg1: #ff9a9e;
      --bg2: #fad0c4;
      --accent: #ff4d6d;
      --card: #ffffff;
      --glass: rgba(255,255,255,0.18);
      --text: #2b2b2b;
      --radius: 18px;
      --shadow: 0 12px 30px rgba(0,0,0,0.18);
      --max-width: 980px;
      --transition: 300ms cubic-bezier(.2,.9,.3,1);
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.001ms !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
    }

    html,body{height:100%;margin:0;font-family:Inter, 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial; color:var(--text); background:linear-gradient(135deg,var(--bg1),var(--bg2)); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}

    .wrap{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px;
      box-sizing:border-box;
    }

    /* FRONT CARD */
    .front {
      width:100%;
      max-width:420px;
      background:linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.06));
      border-radius:var(--radius);
      padding:28px;
      text-align:center;
      box-shadow:var(--shadow);
      backdrop-filter: blur(6px);
      cursor:pointer;
      border:1px solid rgba(255,255,255,0.12);
      transition: transform var(--transition), box-shadow var(--transition);
      outline: none;
    }
    .front:focus, .front:hover { transform: translateY(-6px) scale(1.01); box-shadow: 0 20px 40px rgba(0,0,0,0.22); }

    .avatar {
      width:220px;height:220px;border-radius:50%;object-fit:cover;border:8px solid var(--accent); box-shadow: 0 18px 40px rgba(0,0,0,0.28); display:block;margin:0 auto; transition: transform 600ms ease;
    }
    .front h1{ margin:18px 0 6px; color:var(--accent); font-size:1.6rem; letter-spacing:0.6px; }
    .front p{ margin:0; opacity:0.9; font-style:italic; }

    /* MAIN CONTENT */
    .content {
      width:100%;
      max-width:var(--max-width);
      margin: 24px auto;
      display:none;
      gap:28px;
      align-items:flex-start;
      justify-content:center;
      padding:28px;
      box-sizing:border-box;
    }

    .content.show { display:flex; flex-direction:column; animation: fadeIn 900ms ease both; }

    .topbar {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      width:100%;
    }

    .big-heart {
      font-size:4.6rem;
      color:var(--accent);
      transform-origin:center;
      animation: pop 900ms cubic-bezier(.2,.9,.3,1) both;
      margin:0;
    }

    .controls {
      display:flex;
      gap:10px;
      align-items:center;
    }

    .btn {
      background:var(--card);
      border-radius:12px;
      padding:8px 12px;
      border:1px solid rgba(0,0,0,0.06);
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      cursor:pointer;
      transition: transform 160ms ease, box-shadow 160ms ease;
      font-weight:600;
    }
    .btn:active { transform: translateY(1px); }
    .btn.secondary { background:transparent; border:1px solid rgba(255,255,255,0.12); color:white; }

    /* layout */
    .main-grid {
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:28px;
      width:100%;
    }
    @media (max-width:980px){ .main-grid{ grid-template-columns: 1fr; } }

    /* Gallery */
    .gallery {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap:16px;
      align-items:stretch;
    }
    .gallery img {
      width:100%; height:160px; object-fit:cover; border-radius:14px; box-shadow: 0 10px 30px rgba(0,0,0,0.12); cursor:pointer; transition: transform var(--transition), box-shadow var(--transition);
    }
    .gallery img:focus, .gallery img:hover { transform: translateY(-6px) scale(1.02); box-shadow: 0 18px 40px rgba(0,0,0,0.18); outline: none; }

    /* Message card */
    .message {
      background:var(--card);
      padding:22px;
      border-radius:16px;
      box-shadow:var(--shadow);
      line-height:1.6;
    }
    .message h2 { color:var(--accent); margin:0 0 8px; }
    .message p { margin:8px 0; }

    /* Countdown & typewriter */
    .meta {
      display:flex;
      gap:12px;
      align-items:center;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .pill {
      background:var(--glass);
      padding:8px 12px;
      border-radius:999px;
      color:white;
      font-weight:600;
      border:1px solid rgba(255,255,255,0.08);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }

    /* Lightbox modal */
    .lightbox {
      position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:1200;
      background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.6));
      padding:24px;
    }
    .lightbox.show { display:flex; }
    .lightbox .panel {
      max-width:920px; width:100%; border-radius:14px; overflow:hidden; background:rgba(255,255,255,0.02); box-shadow: 0 30px 80px rgba(0,0,0,0.6);
    }
    .lightbox img { width:100%; height:auto; display:block; object-fit:contain; background:#111; }

    .lb-controls { display:flex; gap:8px; padding:12px; justify-content:space-between; align-items:center; background:rgba(0,0,0,0.35); color:white; }

    /* Confetti canvas */
    #confetti { position:fixed; inset:0; pointer-events:none; z-index:1100; display:none; }

    /* small utilities */
    .muted { opacity:0.8; font-size:0.95rem; }
    .center { text-align:center; }
    .sr-only { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }

    @keyframes fadeIn { from { opacity:0; transform: translateY(8px); } to { opacity:1; transform:none; } }
    @keyframes pop { 0%{ transform: scale(0.2); opacity:0 } 60%{ transform: scale(1.2); opacity:1 } 100%{ transform: scale(1); } }
  </style>
</head>
<body>

  <div class="wrap" id="app">

    <!-- FRONT CARD (keyboard accessible) -->
    <div class="front" id="frontCard" role="button" tabindex="0" aria-pressed="false" aria-label="Open my love message. Press Enter or Space to open.">
      <img src="front.jpg" alt="Front photo" class="avatar" id="frontAvatar" loading="lazy" />
      <h1>Tap or press Enter ❤️</h1>
      <p>Someone misses you a lot…</p>
      <p class="muted" style="margin-top:12px;">Click to reveal a surprise</p>
    </div>

    <!-- MAIN CONTENT -->
    <div class="content" id="loveContent" aria-hidden="true">
      <div class="topbar">
        <div style="display:flex;gap:12px;align-items:center;">
          <div class="big-heart" aria-hidden="true">❤️</div>
          <div>
            <h3 style="margin:0;">My Love</h3>
            <div class="meta">
              <div class="pill" id="countdown" aria-live="polite">Counting...</div>
              <div class="pill" id="locationPill">From Phagwara</div>
            </div>
          </div>
        </div>

        <div class="controls" role="toolbar" aria-label="Controls">
          <button class="btn" id="playBtn" aria-pressed="false" title="Play / Pause music">Play music</button>
          <button class="btn" id="confettiBtn" title="Celebrate">Celebrate</button>
          <button class="btn" id="shareBtn" title="Share this page">Share</button>
        </div>
      </div>

      <div class="main-grid" style="margin-top:18px;">
        <!-- left: gallery + message -->
        <div>
          <div class="gallery" id="gallery" aria-label="Photo gallery">
            <img src="img1.jpg" alt="Her smile" tabindex="0" data-index="0" loading="lazy" />
            <img src="img2.jpg" alt="Her eyes" tabindex="0" data-index="1" loading="lazy" />
            <img src="img3.jpg" alt="Her laugh" tabindex="0" data-index="2" loading="lazy" />
            <!-- add more images as needed -->
          </div>

          <div class="message" style="margin-top:18px;">
            <h2>To the one I miss</h2>
            <p id="typewriter" aria-live="polite"></p>
            <p>One day, I won’t be looking at your pictures — I’ll be holding your hands.</p>
            <p><strong>Forever yours ❤️</strong></p>
          </div>
        </div>

        <!-- right: side card -->
        <aside style="width:100%;max-width:420px;">
          <div class="message center">
            <h3 style="margin-top:0;">Little extras</h3>
            <p class="muted">Use the gallery to view photos. Click any photo to open it larger. Use arrow keys to navigate the lightbox.</p>

            <div style="display:flex;gap:8px;justify-content:center;margin-top:12px;">
              <button class="btn" id="downloadBtn">Download photo</button>
              <button class="btn secondary" id="muteBtn">Mute</button>
            </div>

            <div style="margin-top:14px;">
              <label class="muted" for="volume">Volume</label>
              <input id="volume" type="range" min="0" max="1" step="0.01" value="0.6" style="width:100%;margin-top:6px;">
            </div>
          </div>
        </aside>
      </div>
    </div>

  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="panel" role="document">
      <div class="lb-controls">
        <div>
          <button class="btn" id="prevBtn" title="Previous image">◀</button>
          <button class="btn" id="nextBtn" title="Next image">▶</button>
        </div>
        <div style="display:flex;gap:8px;align-items:center;">
          <span id="lbCaption" class="muted">Photo</span>
          <button class="btn" id="closeLb" title="Close">Close ✕</button>
        </div>
      </div>
      <img src="" alt="" id="lbImage" />
    </div>
  </div>

  <!-- Confetti canvas -->
  <canvas id="confetti" aria-hidden="true"></canvas>

  <!-- Hidden audio -->
  <audio id="bgMusic" loop preload="none">
    <source src="music.mp3" type="audio/mpeg">
    <!-- If user doesn't provide music, audio will be ignored -->
  </audio>

  <script>
    // ---------- Config ----------
    const meetDate = new Date('2026-02-14T00:00:00'); // edit to your meet date
    const typeLines = [
      "Every picture of you makes my heart skip a beat.",
      "Distance means nothing when someone means everything.",
      "I carry you with me in every breath, every thought, and every dream."
    ];

    // ---------- Elements ----------
    const frontCard = document.getElementById('frontCard');
    const loveContent = document.getElementById('loveContent');
    const confettiCanvas = document.getElementById('confetti');
    const playBtn = document.getElementById('playBtn');
    const muteBtn = document.getElementById('muteBtn');
    const volume = document.getElementById('volume');
    const bgMusic = document.getElementById('bgMusic');
    const confettiBtn = document.getElementById('confettiBtn');
    const shareBtn = document.getElementById('shareBtn');
    const gallery = document.getElementById('gallery');
    const lightbox = document.getElementById('lightbox');
    const lbImage = document.getElementById('lbImage');
    const lbCaption = document.getElementById('lbCaption');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const closeLb = document.getElementById('closeLb');
    const downloadBtn = document.getElementById('downloadBtn');
    const countdownEl = document.getElementById('countdown');
    const typewriterEl = document.getElementById('typewriter');

    // ---------- Accessibility: open via keyboard ----------
    function openLove() {
      frontCard.style.display = 'none';
      loveContent.classList.add('show');
      loveContent.setAttribute('aria-hidden', 'false');
      confettiBurst(); // small celebration
      startTypewriter();
      updateCountdown();
      // autoplay music only if user interacted (we have interaction)
      try { bgMusic.volume = parseFloat(volume.value); bgMusic.play().catch(()=>{}); playBtn.textContent = 'Pause music'; playBtn.setAttribute('aria-pressed','true'); } catch(e){}
    }

    frontCard.addEventListener('click', openLove);
    frontCard.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openLove(); }
    });

    // ---------- Typewriter ----------
    let lineIndex = 0;
    function startTypewriter() {
      typewriterEl.textContent = '';
      typeLine();
    }
    function typeLine() {
      const text = typeLines[lineIndex % typeLines.length];
      let i = 0;
      typewriterEl.textContent = '';
      const t = setInterval(() => {
        typewriterEl.textContent += text.charAt(i);
        i++;
        if (i >= text.length) {
          clearInterval(t);
          lineIndex++;
          setTimeout(typeLine, 1200);
        }
      }, 36);
    }

    // ---------- Countdown ----------
    function updateCountdown() {
      function fmt(n){ return String(n).padStart(2,'0'); }
      const now = new Date();
      const diff = meetDate - now;
      if (diff <= 0) {
        countdownEl.textContent = 'Together now ❤️';
        return;
      }
      const days = Math.floor(diff / (1000*60*60*24));
      const hours = Math.floor((diff / (1000*60*60)) % 24);
      const minutes = Math.floor((diff / (1000*60)) % 60);
      const seconds = Math.floor((diff / 1000) % 60);
      countdownEl.textContent = `${days}d ${fmt(hours)}h ${fmt(minutes)}m ${fmt(seconds)}s`;
      setTimeout(updateCountdown, 1000);
    }

    // ---------- Music controls ----------
    playBtn.addEventListener('click', () => {
      if (bgMusic.paused) {
        bgMusic.play().catch(()=>{});
        playBtn.textContent = 'Pause music';
        playBtn.setAttribute('aria-pressed','true');
      } else {
        bgMusic.pause();
        playBtn.textContent = 'Play music';
        playBtn.setAttribute('aria-pressed','false');
      }
    });
    muteBtn.addEventListener('click', () => {
      bgMusic.muted = !bgMusic.muted;
      muteBtn.textContent = bgMusic.muted ? 'Unmute' : 'Mute';
    });
    volume.addEventListener('input', () => {
      bgMusic.volume = parseFloat(volume.value);
    });

    // ---------- Confetti (simple) ----------
    function confettiBurst() {
      const canvas = confettiCanvas;
      const ctx = canvas.getContext('2d');
      canvas.width = innerWidth;
      canvas.height = innerHeight;
      canvas.style.display = 'block';
      const pieces = [];
      const colors = ['#ff4d6d','#ffd166','#6ee7b7','#9ad0f5','#c084fc'];
      for (let i=0;i<120;i++){
        pieces.push({
          x: Math.random()*canvas.width,
          y: Math.random()*canvas.height - canvas.height,
          vx: (Math.random()-0.5)*6,
          vy: Math.random()*6+2,
          size: Math.random()*8+4,
          color: colors[Math.floor(Math.random()*colors.length)],
          rot: Math.random()*360,
          vr: (Math.random()-0.5)*8
        });
      }
      let t0 = null;
      function frame(ts){
        if (!t0) t0 = ts;
        const dt = ts - t0;
        t0 = ts;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for (let p of pieces){
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.12;
          p.rot += p.vr;
          ctx.save();
          ctx.translate(p.x,p.y);
          ctx.rotate(p.rot * Math.PI/180);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
          ctx.restore();
        }
        // remove pieces that fall below
        for (let i=pieces.length-1;i>=0;i--){
          if (pieces[i].y > canvas.height + 50) pieces.splice(i,1);
        }
        if (pieces.length>0) requestAnimationFrame(frame);
        else { canvas.style.display='none'; ctx.clearRect(0,0,canvas.width,canvas.height); }
      }
      requestAnimationFrame(frame);
    }
    confettiBtn.addEventListener('click', confettiBurst);

    // ---------- Share ----------
    shareBtn.addEventListener('click', async () => {
      const shareData = { title: document.title, text: 'A little surprise for you', url: location.href };
      if (navigator.share) {
        try { await navigator.share(shareData); } catch(e) { alert('Share canceled'); }
      } else {
        // fallback: copy url
        navigator.clipboard?.writeText(location.href).then(()=> alert('Link copied to clipboard'));
      }
    });

    // ---------- Gallery & Lightbox ----------
    const imgs = Array.from(gallery.querySelectorAll('img'));
    let currentIndex = 0;
    function openLightbox(index){
      const img = imgs[index];
      lbImage.src = img.src;
      lbImage.alt = img.alt || 'Photo';
      lbCaption.textContent = img.alt || `Photo ${index+1}`;
      lightbox.classList.add('show');
      lightbox.setAttribute('aria-hidden','false');
      currentIndex = index;
      document.body.style.overflow = 'hidden';
    }
    function closeLightbox(){
      lightbox.classList.remove('show');
      lightbox.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }
    imgs.forEach((img, i) => {
      img.addEventListener('click', ()=> openLightbox(i));
      img.addEventListener('keydown', (e)=> { if (e.key === 'Enter' || e.key === ' ') openLightbox(i); });
    });
    prevBtn.addEventListener('click', ()=> { currentIndex = (currentIndex-1+imgs.length)%imgs.length; openLightbox(currentIndex); });
    nextBtn.addEventListener('click', ()=> { currentIndex = (currentIndex+1)%imgs.length; openLightbox(currentIndex); });
    closeLb.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e)=> { if (e.target === lightbox) closeLightbox(); });

    // keyboard navigation
    document.addEventListener('keydown', (e)=>{
      if (lightbox.classList.contains('show')) {
        if (e.key === 'ArrowRight') nextBtn.click();
        if (e.key === 'ArrowLeft') prevBtn.click();
        if (e.key === 'Escape') closeLightbox();
      }
    });

    // download current photo
    downloadBtn.addEventListener('click', ()=>{
      const url = imgs[currentIndex]?.src || imgs[0].src;
      const a = document.createElement('a');
      a.href = url;
      a.download = `photo-${currentIndex+1}.jpg`;
      document.body.appendChild(a);
      a.click();
      a.remove();
    });

    // initialize currentIndex to 0
    currentIndex = 0;

    // ---------- small helpers ----------
    // If user hasn't provided music file, hide controls gracefully
    bgMusic.addEventListener('error', ()=> {
      playBtn.style.display = 'none';
      muteBtn.style.display = 'none';
      volume.style.display = 'none';
    });

    // set initial volume
    bgMusic.volume = parseFloat(volume.value);

    // ensure lightbox image index updates when opened by gallery click
    gallery.addEventListener('click', (e)=>{
      const img = e.target.closest('img');
      if (!img) return;
      const idx = parseInt(img.dataset.index || imgs.indexOf(img), 10);
      if (!isNaN(idx)) currentIndex = idx;
    });

    // small UX: when page loads, focus front card
    window.addEventListener('load', ()=> frontCard.focus());
  </script>
</body>
</html>